<section class="fondo">
  <div class="container">
    <h2 class="text-center mt-4">Mis Turnos</h2>

    <!-- Filtros -->
    <div class="row justify-content-center my-3">
      <input
        type="text"
        class="form-control mx-2"
        placeholder="Filtrar por Especialidad"
        [(ngModel)]="especialidadFiltro"
        style="width: 40%;"
      />
      <input
        type="text"
        class="form-control mx-2"
        placeholder="Filtrar por Especialista"
        [(ngModel)]="especialistaFiltro"
        style="width: 40%;"
      />
    </div>

    <!-- Tabla de turnos -->
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Especialista</th>
          <th>Especialidad</th>
          <th>Fecha</th>
          <th>Horario</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let turno of aplicarFiltros()">
          <td>{{ turno.especialista.nombre }} {{ turno.especialista.apellido }}</td>
          <td>{{ turno.especialidad }}</td>
          <td>{{ turno.fecha }}</td>
          <td>{{ turno.desde }} - {{ turno.hasta }}</td>
          <td>{{ turno.estado }}</td>
          <td>
            <button
              *ngIf="turno.estado === 'pendiente'"
              class="btn btn-danger btn-sm"
              (click)="cancelarTurno(turno)"
            >
              Cancelar
            </button>
            <button
              *ngIf="turno.estado === 'realizado'"
              class="btn btn-primary btn-sm"
              (click)="calificarAtencion(turno)"
            >
              Calificar
            </button>
            <button
              *ngIf="turno.estado === 'realizado' && turno.comentario"
              class="btn btn-success btn-sm"
              (click)="completarEncuesta(turno)"
            >
              Completar Encuesta
            </button>

            <button
            *ngIf="turno.comentario && (turno.estado === 'Realizado' || turno.estado === 'Cancelado' || turno.estado === 'Rechazado')"
            class="btn btn-info btn-sm"
            (click)="verResenia(turno)"
          >
            Ver Rese√±a
          </button>
          </td>
        </tr>
        <tr *ngIf="aplicarFiltros().length === 0">
          <td colspan="6" class="text-center">No se encontraron turnos.</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
