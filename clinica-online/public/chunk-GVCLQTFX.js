import{a as K,b as z,c as G,d as B,e as H}from"./chunk-KOHUDCZX.js";import"./chunk-HEQS3XIX.js";import{a as k,b as n,c as O,d as I,e as M,f as A,g as N,h as L,l as U,n as V}from"./chunk-BOPBXZUS.js";import{a as j}from"./chunk-BLVJNDES.js";import{d as F,f as R,j as w}from"./chunk-VWKJVGVK.js";import{F as q,u as D,z as T}from"./chunk-OIS752W6.js";import{Ea as p,Fa as d,Pa as x,Sa as _,Ua as P,Va as o,Wa as e,Xa as m,Ya as C,Za as u,_a as b,ab as r,cb as y,d as Y,f as g,fa as S,fb as E,oa as h,pa as v}from"./chunk-X5LPCB6T.js";var f=Y(K());function W(s,t){if(s&1&&(o(0,"div")(1,"strong")(2,"label",35),r(3),e()()()),s&2){let i=b();p(3),y(" ",i.msjError," ")}}function J(s,t){if(s&1){let i=C();o(0,"button",36),u("click",function(){h(i);let l=b();return v(l.SeccionUsuarios())}),r(1," ATRAS "),e()}}function Q(s,t){if(s&1){let i=C();o(0,"button",36),u("click",function(){h(i);let l=b();return v(l.Home())}),r(1," ATRAS "),e()}}var $=class s{constructor(t,i,a,l,c,X){this.fb=t;this.authService=i;this.auth=a;this.firestoreService=l;this.router=c;this.imagenService=X;this.registroForm=this.fb.group({nombre:["",n.required],apellido:["",n.required],edad:["",[n.required,n.min(1),n.max(120)]],dni:["",[n.required,n.pattern("^[0-9]{8}$")]],obraSocial:["",n.required],correo:["",[n.required,n.email]],contrasena:["",[n.required,n.minLength(8)]],fotoPerfilUno:["",[n.required]],fotoPerfilDos:["",[n.required]]})}registroForm;file1;file2;token=!1;msjError="";usuarioLogueado=null;proximaRuta="";ngOnInit(){return g(this,null,function*(){T(this.auth,t=>{t?this.usuarioLogueado=t:this.usuarioLogueado=null})})}onSubmit(){return g(this,null,function*(){if(this.usuarioLogueado!=null){let t=this.usuarioLogueado.uid;console.log(t);let i=yield this.firestoreService.getUsuarioInfo(t);this.proximaRuta="/home",console.log(i.correo),console.log(i.contrasena)}for(let t in this.registroForm.controls){let i=this.registroForm.get(t);if(i?.invalid){this.msjError=`Campo inv\xE1lido: ${t}`,console.log(`Campo inv\xE1lido: ${t}`,i.errors);return}}this.registroForm.valid?(console.log("antes de llamar a crearpaciente()"),yield this.crearPaciente()):f.default.fire({title:"ERROR",html:"Por favor verifica los datos ingresados.",icon:"error",didOpen:()=>{document.documentElement.classList.remove("swal2-height-auto"),document.body.classList.remove("swal2-height-auto")}})})}SeccionUsuarios(){this.router.navigate(["/seccionUsuarios"])}Home(){this.router.navigate([""])}uploadImageUno(t){this.file1=t.target.files[0]}executeRecaptchaVisible(t){this.token=!this.token}uploadImageDos(t){this.file2=t.target.files[0]}crearPaciente(){return g(this,null,function*(){let t=yield this.imagenService.subirImg(this.file1),i=yield this.imagenService.subirImg(this.file2),a={nombre:this.registroForm.get("nombre")?.value,apellido:this.registroForm.get("apellido")?.value,edad:this.registroForm.get("edad")?.value,dni:this.registroForm.get("dni")?.value,obraSocial:this.registroForm.get("obraSocial")?.value,correo:this.registroForm.get("correo")?.value,contrasena:this.registroForm.get("contrasena")?.value,autorizado:"no",urlFotoPerfil:t,urlFotoPerfilDos:i,rol:"paciente"};try{if(console.log("por crear paciente"),this.token){if(this.usuarioLogueado!=null){let l=this.usuarioLogueado.uid,c=yield this.firestoreService.getUsuarioInfo(l);yield this.authService.createUser("paciente",a,this.registroForm.get("correo")?.value,this.registroForm.get("contrasena")?.value,c.correo,c.contrasena)}else console.log("lo creo sin estar logueado"),yield this.authService.createUser("paciente",a,this.registroForm.get("correo")?.value,this.registroForm.get("contrasena")?.value);this.registroForm.reset(),f.default.fire({title:"Paciente registrado",text:"\xA1Ya puede empezar a usar nuestro sitio!",icon:"success",confirmButtonText:"Aceptar",backdrop:"rgba(0,0,0,0.8)",didOpen:()=>{document.documentElement.classList.remove("swal2-height-auto"),document.body.classList.remove("swal2-height-auto")}}),this.router.navigate([this.proximaRuta])}else f.default.fire({title:"Error",text:"Verifica que no es un robot para continuar",icon:"error"})}catch{f.default.fire({title:"ERROR",html:"Hubo un problema al registrar al paciente.",icon:"error",didOpen:()=>{document.documentElement.classList.remove("swal2-height-auto"),document.body.classList.remove("swal2-height-auto")}})}})}static \u0275fac=function(i){return new(i||s)(d(U),d(j),d(D),d(q),d(w),d(H))};static \u0275cmp=S({type:s,selectors:[["app-registro-paciente"]],standalone:!0,features:[E],decls:55,vars:3,consts:[[1,"fondo"],[1,"container"],[1,"form-container"],[1,"card"],[1,"card-body"],[1,"title"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","nombre"],["id","nombre","formControlName","nombre","type","text",1,"form-input"],["for","apellido"],["id","apellido","formControlName","apellido","type","text",1,"form-input"],["for","edad"],["id","edad","formControlName","edad","type","number",1,"form-input"],["for","dni"],["id","dni","formControlName","dni","type","text",1,"form-input"],["for","obraSocial"],["id","obraSocial","formControlName","obraSocial","type","text",1,"form-input"],["for","correo"],["id","correo","formControlName","correo","type","email",1,"form-input"],["for","contrasena"],["id","contrasena","formControlName","contrasena","type","password",1,"form-input"],[1,"row","mb-2"],[1,"col-md-6","form-floating","form-control-group","p-1","mb-2"],["type","file","id","fotoPerfilUno","formControlName","fotoPerfilUno",1,"form-control","small-input",3,"change"],["for","fotoPerfil1",1,"form-label","small-label"],["type","file","id","fotoPerfilDos","formControlName","fotoPerfilDos",1,"form-control","small-input",3,"change"],["for","fotoPerfil2",1,"form-label","small-label"],["siteKey","6LfBWIoqAAAAAG9GDoRLUsrzEVeUtSbt1F7z--Y7",3,"resolved"],[1,"button-container"],["type","submit",1,"submit-button"],[4,"ngIf"],[1,"text-end"],[1,"btn","btn-primary","btn-lg","px-5","mb-4",2,"background-color","brown","color","white"],[1,"form-label",2,"color","red"],[1,"btn","btn-primary","btn-lg","px-5","mb-4",2,"background-color","brown","color","white",3,"click"]],template:function(i,a){i&1&&(o(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),r(6,"Registro de Paciente"),e(),o(7,"p",6),r(8,"Por favor ingrese los datos requeridos"),e(),o(9,"form",7),u("ngSubmit",function(){return a.onSubmit()}),o(10,"div",8)(11,"label",9),r(12,"Nombre"),e(),m(13,"input",10),e(),o(14,"div",8)(15,"label",11),r(16,"Apellido"),e(),m(17,"input",12),e(),o(18,"div",8)(19,"label",13),r(20,"Edad"),e(),m(21,"input",14),e(),o(22,"div",8)(23,"label",15),r(24,"DNI"),e(),m(25,"input",16),e(),o(26,"div",8)(27,"label",17),r(28,"Obra Social"),e(),m(29,"input",18),e(),o(30,"div",8)(31,"label",19),r(32,"Correo"),e(),m(33,"input",20),e(),o(34,"div",8)(35,"label",21),r(36,"Contrase\xF1a"),e(),m(37,"input",22),e(),o(38,"div",23)(39,"div",24)(40,"input",25),u("change",function(c){return a.uploadImageUno(c)}),e(),o(41,"label",26),r(42,"Primera foto de perfil"),e()(),o(43,"div",24)(44,"input",27),u("change",function(c){return a.uploadImageDos(c)}),e(),o(45,"label",28),r(46,"Segunda foto de perfil"),e()()(),o(47,"re-captcha",29),u("resolved",function(c){return a.executeRecaptchaVisible(c)}),e(),o(48,"div",30)(49,"button",31),r(50,"Registrar Paciente"),e()(),x(51,W,4,1,"div",32),e()(),o(52,"div",33),x(53,J,2,0,"button",34)(54,Q,2,0,"button",34),e()()()()()),i&2&&(p(9),_("formGroup",a.registroForm),p(42),_("ngIf",a.msjError!=""),p(2),P(a.usuarioLogueado!=null?53:54))},dependencies:[V,M,k,A,O,I,N,L,R,F,G,z,B],styles:[".fondo[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;align-items:center;margin:0;padding:0;background:linear-gradient(45deg,gold,#e48080);background-attachment:fixed;background-size:cover;background-repeat:no-repeat}.especialidad[_ngcontent-%COMP%]{color:black !}.container[_ngcontent-%COMP%]{max-width:600px;width:100%;padding:20px}.select-black[_ngcontent-%COMP%]{color:#000;background-color:#fff;border:1px solid #ffee00;border-radius:5px;padding:10px;appearance:none;-webkit-appearance:none;-moz-appearance:none}.select-black[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.card[_ngcontent-%COMP%]{background-color:#343a40;border-radius:1rem;padding:2rem;color:#fff;text-align:center;box-shadow:0 8px 20px #0003}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px}label[_ngcontent-%COMP%]{margin-bottom:5px;font-size:.9rem;color:#ccc;text-align:left}.form-input[_ngcontent-%COMP%]{padding:10px;border:1px solid rgba(255,255,255,.3);border-radius:5px;background-color:#ffffff1a;color:#fff;font-size:1rem;transition:border .3s}.form-input[_ngcontent-%COMP%]:focus{outline:none;border:1px solid #ffee00}.new-specialty[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.specialty-container[_ngcontent-%COMP%]{display:flex;gap:10px}.specialty-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 15px;border:none;background-color:#fe0;color:#000;border-radius:5px;cursor:pointer;font-size:.9rem;transition:background-color .3s ease}.specialty-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background-color:#e6d000}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}.submit-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:1rem;border:none;background-color:#4caf50;color:#fff;border-radius:5px;cursor:pointer;transition:background-color .3s ease}.submit-button[_ngcontent-%COMP%]:hover{background-color:#45a045}"]})};export{$ as RegistroPacienteComponent};
