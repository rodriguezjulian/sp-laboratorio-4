import{a as X,b as H,c as Y,d as K,e as W}from"./chunk-KOHUDCZX.js";import"./chunk-HEQS3XIX.js";import{a as P,b as a,c as M,d as I,e as N,f as A,g as L,h as V,i as T,j as q,k as U,l as j,n as z}from"./chunk-BOPBXZUS.js";import{a as $}from"./chunk-BLVJNDES.js";import{c as w,d as k,f as O,j as R}from"./chunk-VWKJVGVK.js";import{F as B,u as G,z as D}from"./chunk-OIS752W6.js";import{Ea as d,Fa as m,Pa as v,Sa as f,Ua as y,Va as i,Wa as e,Xa as c,Ya as _,Za as p,_a as h,ab as r,cb as C,d as Q,f as g,fa as S,fb as F,oa as x,pa as E}from"./chunk-X5LPCB6T.js";var u=Q(X());function Z(l,o){if(l&1&&(i(0,"option",39),r(1),e()),l&2){let t=o.$implicit;f("value",t),d(),C(" ",t," ")}}function ee(l,o){if(l&1&&(i(0,"div")(1,"strong")(2,"label",40),r(3),e()()()),l&2){let t=h();d(3),C(" ",t.msjError," ")}}function te(l,o){if(l&1){let t=_();i(0,"button",41),p("click",function(){x(t);let s=h();return E(s.SeccionUsuarios())}),r(1," ATRAS "),e()}}function ie(l,o){if(l&1){let t=_();i(0,"button",41),p("click",function(){x(t);let s=h();return E(s.Home())}),r(1," ATRAS "),e()}}var J=class l{constructor(o,t,n,s,b,oe){this.firestoreService=o;this.fb=t;this.authService=n;this.router=s;this.imagenService=b;this.auth=oe;this.registroForm=this.fb.group({nombre:["",a.required],apellido:["",a.required],edad:["",[a.required,a.min(18),a.max(100)]],dni:["",[a.required,a.pattern("^[0-9]{8}$")]],especialidad:["",a.required],nuevaEspecialidad:[""],correo:["",[a.required,a.email]],contrasena:["",[a.required,a.minLength(8)]],fotoPerfil:["",[a.required]]})}especialidades=[""];registroForm;imagenPerfil=null;file;msjError="";token=!1;usuarioLogueado=null;ngOnInit(){return g(this,null,function*(){let o=yield this.firestoreService.getEspecialidades();this.especialidades=o.map(t=>t.descripcion),D(this.auth,t=>{t?this.usuarioLogueado=t:this.usuarioLogueado=null})})}Home(){this.router.navigate([""])}uploadImageUno(o){this.file=o.target.files[0]}agregarEspecialidad(){return g(this,null,function*(){if(this.registroForm.get("nuevaEspecialidad")?.value!=""){let o={descripcion:this.registroForm.get("nuevaEspecialidad")?.value};yield this.firestoreService.createDocument("especialidades",o);let t=yield this.firestoreService.getEspecialidades();this.especialidades=t.map(n=>n.descripcion),u.default.fire({title:"Especilidad creada",html:"Gracias por contribuir a nuestra base de datos.",icon:"success",didOpen:()=>{document.documentElement.classList.remove("swal2-height-auto"),document.body.classList.remove("swal2-height-auto")}})}})}executeRecaptchaVisible(o){this.token=!this.token}onSubmit(){return g(this,null,function*(){for(let o in this.registroForm.controls){let t=this.registroForm.get(o);t?.invalid&&(this.msjError=`Campo inv\xE1lido: ${o}`,console.log(`Campo inv\xE1lido: ${o}`,t.errors))}if(console.log("recien toque el boton"),this.registroForm.valid)if(console.log("previo a llamar a crearEspecialista()"),this.token)yield this.crearEspecialista(),this.registroForm.reset();else{u.default.fire({title:"Error",text:"Verifica que no es un robot para continuar",icon:"error"});return}else u.default.fire({title:"ERROR",html:"Por favor verifica los datos ingresados.",icon:"error",didOpen:()=>{document.documentElement.classList.remove("swal2-height-auto"),document.body.classList.remove("swal2-height-auto")}})})}crearEspecialista(){return g(this,null,function*(){console.log("antes de subir la imagen");let o=yield this.imagenService.subirImg(this.file);console.log("despues de subir la img");let t={nombre:this.registroForm.get("nombre")?.value,apellido:this.registroForm.get("apellido")?.value,edad:this.registroForm.get("edad")?.value,dni:this.registroForm.get("dni")?.value,especialidad:this.registroForm.get("especialidad")?.value,correo:this.registroForm.get("correo")?.value,contrasena:this.registroForm.get("contrasena")?.value,autorizado:"no",urlFotoPerfil:o};console.log("cree la constante del cliente"),console.log(t);try{if(this.usuarioLogueado!=null){let n=this.usuarioLogueado.uid,s=yield this.firestoreService.getUsuarioInfo(n);yield this.authService.createUser("especialista",t,this.registroForm.get("correo")?.value,this.registroForm.get("contrasena")?.value,s.correo,s.contrasena)}else yield this.authService.createUser("especialista",t,this.registroForm.get("correo")?.value,this.registroForm.get("contrasena")?.value);u.default.fire({title:"Especialista creado",text:"\xA1Ya puede empezar a usar nuestro sitio!",icon:"success",confirmButtonText:"Aceptar",backdrop:"rgba(0,0,0,0.8)",didOpen:()=>{document.documentElement.classList.remove("swal2-height-auto"),document.body.classList.remove("swal2-height-auto")}}),this.usuarioLogueado==null?this.router.navigate(["/login"]):this.router.navigate(["/home"])}catch{u.default.fire({title:"ERROR",html:"Por favor verifica los datos ingresados.",icon:"error",didOpen:()=>{document.documentElement.classList.remove("swal2-height-auto"),document.body.classList.remove("swal2-height-auto")}})}})}SeccionUsuarios(){this.router.navigate(["/seccionUsuarios"])}static \u0275fac=function(t){return new(t||l)(m(B),m(j),m($),m(R),m(W),m(G))};static \u0275cmp=S({type:l,selectors:[["app-registro-especialista"]],standalone:!0,features:[F],decls:60,vars:4,consts:[[1,"fondo"],[1,"container"],[1,"form-container"],[1,"card"],[1,"card-body"],[1,"title"],[1,"subtitle"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","nombre"],["id","nombre","formControlName","nombre","type","text",1,"form-input"],["for","apellido"],["id","apellido","formControlName","apellido","type","text",1,"form-input"],["for","edad"],["id","edad","formControlName","edad","type","number",1,"form-input"],["for","dni"],["id","dni","formControlName","dni","type","text",1,"form-input"],["for","especialidad"],["id","especialidad","formControlName","especialidad",1,"form-input","select-black"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","new-specialty"],["for","nuevaEspecialidad"],[1,"specialty-container"],["id","nuevaEspecialidad","formControlName","nuevaEspecialidad","type","text",1,"form-input"],["type","button",1,"btn","btn-secondary",3,"click"],["for","correo"],["id","correo","formControlName","correo","type","email",1,"form-input"],["for","contrasena"],["id","contrasena","formControlName","contrasena","type","password",1,"form-input"],[1,"col-md-6","form-floating","form-control-group","p-1","mb-2"],["type","file","id","fotoPerfil","formControlName","fotoPerfil",1,"form-control","small-input",3,"change"],["for","fotoPerfil",1,"form-label","small-label"],["siteKey","6LfBWIoqAAAAAG9GDoRLUsrzEVeUtSbt1F7z--Y7",3,"resolved"],[1,"button-container"],["type","submit",1,"submit-button"],[4,"ngIf"],[1,"text-end"],[1,"btn","btn-primary","btn-lg","px-5","mb-4",2,"background-color","brown","color","white"],[3,"value"],[1,"form-label",2,"color","red"],[1,"btn","btn-primary","btn-lg","px-5","mb-4",2,"background-color","brown","color","white",3,"click"]],template:function(t,n){t&1&&(i(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),r(6,"Registro de Especialista"),e(),i(7,"p",6),r(8,"Por favor ingrese los datos requeridos"),e(),i(9,"form",7),p("ngSubmit",function(){return n.onSubmit()}),i(10,"div",8)(11,"label",9),r(12,"Nombre"),e(),c(13,"input",10),e(),i(14,"div",8)(15,"label",11),r(16,"Apellido"),e(),c(17,"input",12),e(),i(18,"div",8)(19,"label",13),r(20,"Edad"),e(),c(21,"input",14),e(),i(22,"div",8)(23,"label",15),r(24,"DNI"),e(),c(25,"input",16),e(),i(26,"div",8)(27,"label",17),r(28,"Especialidad"),e(),i(29,"select",18)(30,"option",19),r(31,"Seleccione una especialidad"),e(),v(32,Z,2,2,"option",20),e()(),i(33,"div",21)(34,"label",22),r(35,"Nueva Especialidad"),e(),i(36,"div",23),c(37,"input",24),i(38,"button",25),p("click",function(){return n.agregarEspecialidad()}),r(39,"Agregar"),e()()(),i(40,"div",8)(41,"label",26),r(42,"Correo"),e(),c(43,"input",27),e(),i(44,"div",8)(45,"label",28),r(46,"Contrase\xF1a"),e(),c(47,"input",29),e(),i(48,"div",30)(49,"input",31),p("change",function(b){return n.uploadImageUno(b)}),e(),i(50,"label",32),r(51,"Foto de perfil"),e()(),i(52,"re-captcha",33),p("resolved",function(b){return n.executeRecaptchaVisible(b)}),e(),i(53,"div",34)(54,"button",35),r(55,"Registrar Especialista"),e()(),v(56,ee,4,1,"div",36),e()(),i(57,"div",37),v(58,te,2,0,"button",38)(59,ie,2,0,"button",38),e()()()()()),t&2&&(d(9),f("formGroup",n.registroForm),d(23),f("ngForOf",n.especialidades),d(24),f("ngIf",n.msjError!=""),d(2),y(n.usuarioLogueado!=null?58:59))},dependencies:[z,N,q,U,P,A,T,M,I,L,V,O,w,k,Y,H,K],styles:[".fondo[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;align-items:center;margin:0;padding:0;background:linear-gradient(45deg,gold,#e48080);background-attachment:fixed;background-size:cover;background-repeat:no-repeat}.especialidad[_ngcontent-%COMP%]{color:black !}.container[_ngcontent-%COMP%]{max-width:600px;width:100%;padding:20px}.select-black[_ngcontent-%COMP%]{color:#000;background-color:#fff;border:1px solid #ffee00;border-radius:5px;padding:10px;appearance:none;-webkit-appearance:none;-moz-appearance:none}.select-black[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.card[_ngcontent-%COMP%]{background-color:#343a40;border-radius:1rem;padding:2rem;color:#fff;text-align:center;box-shadow:0 8px 20px #0003}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:20px}label[_ngcontent-%COMP%]{margin-bottom:5px;font-size:.9rem;color:#ccc;text-align:left}.form-input[_ngcontent-%COMP%]{padding:10px;border:1px solid rgba(255,255,255,.3);border-radius:5px;background-color:#ffffff1a;color:#fff;font-size:1rem;transition:border .3s}.form-input[_ngcontent-%COMP%]:focus{outline:none;border:1px solid #ffee00}.new-specialty[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.specialty-container[_ngcontent-%COMP%]{display:flex;gap:10px}.specialty-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 15px;border:none;background-color:#fe0;color:#000;border-radius:5px;cursor:pointer;font-size:.9rem;transition:background-color .3s ease}.specialty-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background-color:#e6d000}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}.submit-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:1rem;border:none;background-color:#4caf50;color:#fff;border-radius:5px;cursor:pointer;transition:background-color .3s ease}.submit-button[_ngcontent-%COMP%]:hover{background-color:#45a045}"]})};export{J as RegistroEspecialistaComponent};
