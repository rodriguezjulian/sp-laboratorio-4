import{a as J}from"./chunk-WRE3YE3W.js";import{a as K}from"./chunk-7FG5ZD4D.js";import{F as G}from"./chunk-JRXB4MSQ.js";import{$b as U,Ab as B,Bb as F,Eb as N,Gb as u,Kc as S,Lc as E,Pc as y,Qc as b,Rb as R,Sb as o,Tb as l,Ua as L,Vb as H,Wa as s,Xa as C,_b as x,cc as f,dc as v,ec as P,fc as q,ia as _,kb as p,la as k,ob as d,qa as z,ra as I,sa as w,tb as T,wb as t,xb as i,yb as j,za as A,zb as $}from"./chunk-SLHCDPS3.js";import{a as M,b as V,j as h}from"./chunk-4ZZIO3ZI.js";var O=class a{transform(n,e="N/A"){return n??e}static \u0275fac=function(e){return new(e||a)};static \u0275pipe=k({name:"reemplazarNulos",type:a,pure:!0,standalone:!0})};var Z=()=>[];function ee(a,n){a&1&&(t(0,"tr")(1,"td",4),o(2,"No hay registros de historia cl\xEDnica"),i()())}function te(a,n){a&1&&(t(0,"td"),o(1,"N/A "),i())}function ie(a,n){a&1&&(t(0,"td"),o(1,"NO"),i())}function ne(a,n){a&1&&(t(0,"td"),o(1,"SI"),i())}function ae(a,n){if(a&1&&p(0,ie,2,0,"td")(1,ne,2,0,"td"),a&2){let e=u().$implicit;T(e.reservarConsulta==!1?0:1)}}function oe(a,n){if(a&1&&(t(0,"tr")(1,"td"),o(2),f(3,"date"),i(),t(4,"td"),o(5),i(),t(6,"td"),o(7),i(),t(8,"td"),o(9),i(),t(10,"td"),o(11),i(),t(12,"td"),o(13),i(),t(14,"td"),o(15),i(),p(16,te,2,0,"td")(17,ae,2,1),t(18,"td"),o(19),f(20,"reemplazarNulos"),i(),t(21,"td"),o(22),f(23,"reemplazarNulos"),i(),t(24,"td"),o(25),f(26,"reemplazarNulos"),i()()),a&2){let e=n.$implicit,c=n.index,r=u();s(2),l(P(3,11,e.fecha,"shortDate")),s(3),l(e.altura),s(2),l(e.peso),s(2),l(e.presion),s(2),l(e.temperatura),s(2),l(e.calificacionSalud),s(2),l(e.diasParaRevisar),s(),T(e!=null&&e.reservarConsulta?17:16),s(3),l(v(20,14,r.datosDinamicosProcesados[c]==null?null:r.datosDinamicosProcesados[c][0])),s(3),l(v(23,16,r.datosDinamicosProcesados[c]==null?null:r.datosDinamicosProcesados[c][1])),s(3),l(v(26,18,r.datosDinamicosProcesados[c]==null?null:r.datosDinamicosProcesados[c][2]))}}var D=class a{paciente;cerrarModal=new A;datosDinamicosProcesados=[];ngOnChanges(n){n.paciente&&n.paciente.currentValue&&this.procesarDatosDinamicos()}ngOnInit(){return h(this,null,function*(){console.log("Desde ver historia clinica",this.paciente),console.log("Datos din\xE1micos procesados:",this.datosDinamicosProcesados)})}procesarDatosDinamicos(){this.datosDinamicosProcesados=this.paciente.historiaClinica.map(n=>n.datosDinamicos.map(e=>`${e.clave}: ${e.valor}`))}cerrar(){this.cerrarModal.emit()}pacienteSeleccionado=null;verHistoriaClinica(n){this.pacienteSeleccionado=n}cerrarHistoriaClinica(){this.pacienteSeleccionado=null}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=_({type:a,selectors:[["app-ver-historia-clinica"]],inputs:{paciente:"paciente"},outputs:{cerrarModal:"cerrarModal"},standalone:!0,features:[z,x],decls:31,vars:3,consts:[[1,"historia-clinica-container"],[1,"table","table-bordered","table-custom"],[4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","8",1,"text-center"]],template:function(e,c){e&1&&(t(0,"div",0)(1,"h3"),o(2,"Historia Cl\xEDnica"),i(),t(3,"table",1)(4,"thead")(5,"tr")(6,"th"),o(7,"Fecha"),i(),t(8,"th"),o(9,"Altura"),i(),t(10,"th"),o(11,"Peso"),i(),t(12,"th"),o(13,"Presi\xF3n"),i(),t(14,"th"),o(15,"Temperatura"),i(),t(16,"th"),o(17,"Nota de salud"),i(),t(18,"th"),o(19,"Dias para volver"),i(),t(20,"th"),o(21,"Debe volver"),i(),t(22,"th"),o(23,"Dato 1"),i(),t(24,"th"),o(25,"Dato 2"),i(),t(26,"th"),o(27,"Dato 3"),i()()(),t(28,"tbody"),p(29,ee,3,0,"tr",2)(30,oe,27,20,"tr",3),i()()()),e&2&&(s(29),d("ngIf",!(!(c.paciente==null||c.paciente.historiaClinica==null)&&c.paciente.historiaClinica.length)),s(),d("ngForOf",(c.paciente==null?null:c.paciente.historiaClinica)||U(2,Z)))},dependencies:[b,S,E,y,O],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px;box-shadow:0 4px 6px #0000001a;background:#fff;border-radius:8px;overflow:hidden}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:10px 15px;text-align:center;font-size:14px}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;text-transform:uppercase;font-weight:700}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#f9f9f9}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f1f1f1}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0f7fa}td[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f4f4f4;font-weight:700}.text-center[_ngcontent-%COMP%]{text-align:center}a[_ngcontent-%COMP%]{width:100%;height:100%}"]})};function re(a,n){if(a&1&&(t(0,"li"),o(1),f(2,"date"),i()),a&2){let e=n.$implicit;s(),H(" ",P(2,2,e.fecha,"shortDate")," - ",e.desde," ")}}function ce(a,n){if(a&1){let e=F();t(0,"div",9),N("click",function(){let r=I(e).$implicit,m=u();return w(m.verHistoriaClinica(r))}),j(1,"img",10),t(2,"div",11)(3,"h5",12),o(4),i(),t(5,"div",13)(6,"strong"),o(7,"\xDAltimos turnos:"),i(),t(8,"ul"),p(9,re,3,5,"li",14),i()()()()}if(a&2){let e=n.$implicit;s(),d("src",e.urlFotoPerfil||"assets/default-avatar.png",L),s(3),H("",e.nombre," ",e.apellido,""),s(5),d("ngForOf",e.ultimosTurnos)}}function se(a,n){if(a&1){let e=F();$(0),t(1,"app-ver-historia-clinica",15),N("cerrarModal",function(){I(e);let r=u();return w(r.cerrarHistoriaClinica())}),i(),B()}if(a&2){let e=u();s(),d("paciente",e.pacienteSeleccionado)}}function le(a,n){a&1&&(t(0,"div",16)(1,"p"),o(2,"Selecciona un paciente para ver su historia cl\xEDnica."),i()())}var W=class a{constructor(n,e,c){this.firestoreService=n;this.auth=e;this.loader=c}pacientes=[];especialistaLogueado;pacienteSeleccionado=null;ngOnInit(){return h(this,null,function*(){try{this.loader.setLoader(!0),this.especialistaLogueado=yield this.auth.obtenerUsuarioActual(),console.log("Especialista logueado en este momento",this.especialistaLogueado.uid);let n=yield this.firestoreService.getCollection("turnos",{where:[{field:"uidEspecialista",op:"==",value:this.especialistaLogueado.uid},{field:"estado",op:"==",value:"Realizado"}]});console.log("Turnos obtenidos: ",n);let e=yield this.firestoreService.getPacientes(),c={};n.forEach(r=>{if(!c[r.uidPaciente]){let m=e.find(g=>g.id===r.uidPaciente);c[r.uidPaciente]=V(M({},m),{ultimosTurnos:[],historiaClinica:[]})}c[r.uidPaciente].ultimosTurnos.push({fecha:r.fecha,desde:r.desde}),r.historiaClinica&&c[r.uidPaciente].historiaClinica.push(M({fecha:r.fecha},r.historiaClinica))}),console.log("Pacientes map: ",c),this.pacientes=Object.values(c).map(r=>(r.ultimosTurnos=r.ultimosTurnos.sort((m,g)=>new Date(g.fecha).getTime()-new Date(m.fecha).getTime()).slice(0,3),r.historiaClinica&&r.historiaClinica.sort((m,g)=>new Date(g.fecha).getTime()-new Date(m.fecha).getTime()),r)),this.loader.setLoader(!1),console.log("Pacientes cargados: ",this.pacientes)}catch(n){console.error("Error al cargar los pacientes:",n)}})}verHistoriaClinica(n){this.pacienteSeleccionado=n}cerrarHistoriaClinica(){this.pacienteSeleccionado=null}static \u0275fac=function(e){return new(e||a)(C(G),C(J),C(K))};static \u0275cmp=_({type:a,selectors:[["app-pacientes-para-especialistas"]],inputs:{pacientes:"pacientes"},standalone:!0,features:[x],decls:11,vars:3,consts:[["noSeleccionado",""],[1,"fondo"],[1,"container-fluid"],[1,"text-center"],[1,"row"],[1,"col-12","col-md-4","pacientes-col"],["class","card mb-4",3,"click",4,"ngFor","ngForOf"],[1,"col-12","col-md-8","historia-col"],[4,"ngIf","ngIfElse"],[1,"card","mb-4",3,"click"],["alt","Foto del paciente",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[4,"ngFor","ngForOf"],[3,"cerrarModal","paciente"],[1,"no-seleccionado"]],template:function(e,c){if(e&1&&(t(0,"div",1)(1,"div",2)(2,"h2",3),o(3,"Pacientes Atendidos"),i(),t(4,"div",4)(5,"div",5),p(6,ce,10,4,"div",6),i(),t(7,"div",7),p(8,se,2,1,"ng-container",8)(9,le,3,0,"ng-template",null,0,q),i()()()()),e&2){let r=R(10);s(6),d("ngForOf",c.pacientes),s(2),d("ngIf",c.pacienteSeleccionado)("ngIfElse",r)}},dependencies:[b,S,E,y,D],styles:[".fondo[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;margin:0;padding:20px;background:linear-gradient(45deg,gold,#e48080);background-attachment:fixed;background-size:cover;background-repeat:no-repeat}.container-fluid[_ngcontent-%COMP%]{width:100%}.pacientes-col[_ngcontent-%COMP%]{overflow-y:auto;height:80vh}.pacientes-col[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{cursor:pointer;border:1px solid #ddd;transition:transform .2s ease}.pacientes-col[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.card-img-top[_ngcontent-%COMP%]{width:100%;height:150px;object-fit:cover;border-radius:8px 8px 0 0;box-shadow:0 4px 6px #0000001a}.historia-col[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:80vh;background:#fffc;border-radius:12px;padding:20px;box-shadow:0 4px 10px #0003}.no-seleccionado[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;color:#666}"]})};export{W as PacientesParaEspecialistasComponent};
